<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SightEdit - Visual Markdown Editor</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      background: #f8f9fa;
      height: 100vh;
      display: flex;
      flex-direction: column;
    }

    .header {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      border-bottom: none;
      padding: 8px 16px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      box-shadow: 0 2px 10px rgba(102, 126, 234, 0.3);
      height: 52px;
    }

    .logo {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .logo-icon {
      font-size: 24px;
      filter: drop-shadow(0 1px 2px rgba(0,0,0,0.2));
      cursor: pointer;
      transition: transform 0.2s;
    }

    .logo-icon:hover {
      transform: scale(1.1);
    }

    .file-info {
      display: flex;
      align-items: center;
      gap: 8px;
      background: rgba(255, 255, 255, 0.15);
      padding: 4px 12px;
      border-radius: 20px;
      backdrop-filter: blur(10px);
      max-width: 250px;
    }

    .file-label {
      display: none;
    }

    .file-name {
      font-size: 13px;
      color: white;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      max-width: 200px;
    }

    .file-name:hover {
      opacity: 0.8;
    }

    .file-name.editing {
      background: rgba(255, 255, 255, 0.95);
      color: #333;
      border: none;
      outline: none;
      padding: 2px 6px;
      border-radius: 3px;
    }

    .modified-indicator {
      color: #ffd700;
      font-size: 8px;
      font-weight: bold;
      vertical-align: super;
      margin-left: 2px;
    }

    /* ãƒ‰ãƒ©ãƒƒã‚°ã‚¢ãƒ³ãƒ‰ãƒ‰ãƒ­ãƒƒãƒ—ç”¨ã‚¹ã‚¿ã‚¤ãƒ« */
    body.drag-over {
      position: relative;
    }

    body.drag-over::after {
      content: "ğŸ“ ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ‰ãƒ­ãƒƒãƒ—ã—ã¦ãã ã•ã„";
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 123, 255, 0.9);
      color: white;
      font-size: 24px;
      font-weight: bold;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      pointer-events: none;
    }

    .header-controls {
      display: flex;
      align-items: center;
      gap: 4px;
    }

    .btn {
      width: 36px;
      height: 36px;
      padding: 0;
      border: none;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.1);
      color: white;
      cursor: pointer;
      font-size: 18px;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
    }

    .btn:hover {
      background: rgba(255, 255, 255, 0.2);
      transform: scale(1.05);
    }

    .btn:active {
      transform: scale(0.95);
    }

    .btn-tooltip {
      position: absolute;
      bottom: -30px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(0, 0, 0, 0.8);
      color: white;
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 12px;
      white-space: nowrap;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.2s;
      z-index: 1000;
    }

    .btn:hover .btn-tooltip {
      opacity: 1;
    }

    .main-container {
      flex: 1;
      display: flex;
      min-height: 0;
    }

    .toolbar {
      background: white;
      border-bottom: 1px solid #dee2e6;
      padding: 8px 16px;
      display: flex;
      align-items: center;
      gap: 8px;
      flex-wrap: wrap;
    }

    .toolbar-group {
      display: flex;
      align-items: center;
      gap: 4px;
      padding-right: 12px;
      border-right: 1px solid #dee2e6;
    }

    .toolbar-group:last-child {
      border-right: none;
    }

    .toolbar-btn {
      padding: 6px 8px;
      border: 1px solid transparent;
      border-radius: 3px;
      background: transparent;
      color: #495057;
      cursor: pointer;
      font-size: 14px;
      transition: all 0.2s;
    }

    .toolbar-btn:hover {
      background: #f8f9fa;
      border-color: #dee2e6;
    }

    .toolbar-btn.active {
      background: #e3f2fd;
      color: #1976d2;
      border-color: #bbdefb;
    }

    .editor-container {
      flex: 1;
      display: flex;
      flex-direction: column;
      background: white;
      margin: 20px;
      border-radius: 8px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
      overflow: hidden;
    }

    .editor-content {
      flex: 1;
      padding: 20px;
      overflow-y: auto;
      min-height: 0;
    }

    .ProseMirror {
      outline: none;
      line-height: 1.6;
      font-size: 16px;
      color: #333;
    }

    .ProseMirror h1,
    .ProseMirror h2,
    .ProseMirror h3,
    .ProseMirror h4,
    .ProseMirror h5,
    .ProseMirror h6 {
      margin: 1.5em 0 0.5em 0;
      font-weight: 600;
      line-height: 1.3;
    }

    .ProseMirror h1 { font-size: 2em; }
    .ProseMirror h2 { font-size: 1.5em; }
    .ProseMirror h3 { font-size: 1.3em; }
    .ProseMirror h4 { font-size: 1.1em; }
    .ProseMirror h5 { font-size: 1em; }
    .ProseMirror h6 { font-size: 0.9em; }

    .ProseMirror p {
      margin: 0.5em 0;
    }

    .ProseMirror ul,
    .ProseMirror ol {
      padding-left: 1.5em;
      margin: 0.5em 0;
    }

    .ProseMirror blockquote {
      border-left: 4px solid #dee2e6;
      padding-left: 1em;
      margin: 1em 0;
      color: #6c757d;
      font-style: italic;
    }

    .ProseMirror code {
      background: #f8f9fa;
      padding: 0.2em 0.4em;
      border-radius: 3px;
      font-family: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, monospace;
      font-size: 0.9em;
    }

    .ProseMirror pre {
      background: #282c34;
      color: #abb2bf;
      border: 1px solid #444;
      border-radius: 6px;
      padding: 1.2em;
      margin: 1.5em 0;
      overflow-x: auto;
      font-family: 'JetBrains Mono', 'Fira Code', 'SF Mono', Monaco, Inconsolata, 'Roboto Mono', monospace;
      font-size: 14px;
      line-height: 1.6;
      white-space: pre;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }

    .ProseMirror pre code {
      background: none;
      padding: 0;
      color: inherit;
      font-size: inherit;
      border-radius: 0;
    }

    /* ã‚³ãƒ¼ãƒ‰ãƒ–ãƒ­ãƒƒã‚¯å†…ã®ã‚·ãƒ³ã‚¿ãƒƒã‚¯ã‚¹ãƒã‚¤ãƒ©ã‚¤ãƒˆé¢¨ */
    .ProseMirror pre .keyword {
      color: #c678dd;
      font-weight: bold;
    }

    .ProseMirror pre .string {
      color: #98c379;
    }

    .ProseMirror pre .comment {
      color: #5c6370;
      font-style: italic;
    }

    .ProseMirror pre .number {
      color: #d19a66;
    }

    .ProseMirror pre .function {
      color: #61afef;
    }

    /* ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ã‚³ãƒ¼ãƒ‰ã®æ”¹è‰¯ */
    .ProseMirror code {
      background: #f1f3f4;
      color: #e74c3c;
      padding: 0.2em 0.4em;
      border-radius: 3px;
      font-family: 'JetBrains Mono', 'Fira Code', 'SF Mono', Monaco, Inconsolata, 'Roboto Mono', monospace;
      font-size: 0.9em;
      border: 1px solid #e1e4e8;
      font-weight: 600;
    }

    /* ã‚¿ã‚¹ã‚¯ãƒªã‚¹ãƒˆ */
    .ProseMirror .task-item {
      display: flex;
      align-items: center;
      margin: 0.5em 0;
    }

    .ProseMirror .task-item input[type="checkbox"] {
      margin-right: 0.5em;
      transform: scale(1.2);
    }

    /* ãƒ†ãƒ¼ãƒ–ãƒ«ã®æ”¹è‰¯ */
    .ProseMirror table,
    .ProseMirror .markdown-table {
      border-collapse: collapse;
      width: 100%;
      margin: 1.5em 0;
      border: 2px solid #dee2e6;
      border-radius: 6px;
      overflow: hidden;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }

    .ProseMirror table th,
    .ProseMirror .markdown-table th {
      background: #f8f9fa;
      font-weight: 600;
      text-align: left;
      padding: 12px;
      border-bottom: 2px solid #dee2e6;
      border-right: 1px solid #dee2e6;
    }

    .ProseMirror table td,
    .ProseMirror .markdown-table td {
      padding: 10px 12px;
      border-bottom: 1px solid #dee2e6;
      border-right: 1px solid #dee2e6;
    }

    .ProseMirror table th:last-child,
    .ProseMirror table td:last-child {
      border-right: none;
    }

    .ProseMirror table tr:hover,
    .ProseMirror .markdown-table tr:hover {
      background: #f8f9fa;
    }

    /* å¼•ç”¨ã®æ”¹è‰¯ */
    .ProseMirror blockquote {
      border-left: 4px solid #007bff;
      background: #f8f9fa;
      padding: 1em 1.5em;
      margin: 1.5em 0;
      color: #6c757d;
      font-style: italic;
      border-radius: 0 4px 4px 0;
    }

    .ProseMirror table {
      border-collapse: collapse;
      width: 100%;
      margin: 1em 0;
    }

    .ProseMirror table td,
    .ProseMirror table th {
      border: 1px solid #dee2e6;
      padding: 0.5em;
      text-align: left;
    }

    .ProseMirror table th {
      background: #f8f9fa;
      font-weight: 600;
    }

    /* WYSIWYG Content styles - contentEditableç”¨ */
    /* WYSIWYG ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ */
    .wysiwyg-editor-content {
      outline: none;
      min-height: 400px;
      padding: 20px;
      line-height: 1.6;
      font-size: 16px;
      color: #333;
      white-space: pre-wrap;
    }

    #wysiwyg-content {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      line-height: 1.6;
      color: #333;
    }

    /* ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ã‚³ãƒ¼ãƒ‰ */
    #wysiwyg-content code {
      background: #f1f3f4;
      color: #e74c3c;
      padding: 0.2em 0.4em;
      border-radius: 3px;
      font-family: 'Monaco', 'Consolas', 'Courier New', monospace;
      font-size: 0.9em;
      border: 1px solid #e1e4e8;
    }

    /* å¼•ç”¨ãƒ–ãƒ­ãƒƒã‚¯ */
    #wysiwyg-content blockquote {
      border-left: 4px solid #007bff;
      background: #f8f9fa;
      padding: 1em 1.5em;
      margin: 1.5em 0;
      border-radius: 0 4px 4px 0;
      color: #495057;
      font-style: italic;
    }

    /* ã‚³ãƒ¼ãƒ‰ãƒ–ãƒ­ãƒƒã‚¯ */
    #wysiwyg-content pre {
      background: #282c34;
      color: #abb2bf;
      border: 1px solid #444;
      border-radius: 6px;
      padding: 1.2em;
      margin: 1.5em 0;
      overflow-x: auto;
      line-height: 1.6;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }

    #wysiwyg-content pre code {
      background: none;
      padding: 0;
      color: inherit;
      border: none;
      font-size: inherit;
    }

    /* ãƒ†ãƒ¼ãƒ–ãƒ« */
    #wysiwyg-content table {
      border-collapse: collapse;
      width: 100%;
      margin: 1.5em 0;
      border: 1px solid #dee2e6;
      border-radius: 6px;
      overflow: hidden;
    }

    #wysiwyg-content table th,
    #wysiwyg-content table td {
      border: 1px solid #dee2e6;
      padding: 10px 12px;
      text-align: left;
      vertical-align: top;
    }

    #wysiwyg-content table th {
      background: #f8f9fa;
      font-weight: 600;
      color: #495057;
    }

    #wysiwyg-content table tr:hover {
      background: #f8f9fa;
    }

    /* ã‚»ãƒ«é…ç½® */
    #wysiwyg-content table td.text-left { text-align: left; }
    #wysiwyg-content table td.text-center { text-align: center; }
    #wysiwyg-content table td.text-right { text-align: right; }

    /* ã‚¿ã‚¹ã‚¯ãƒªã‚¹ãƒˆ */
    #wysiwyg-content .task-item {
      display: flex;
      align-items: flex-start;
      margin: 0.5em 0;
      padding: 0.2em 0;
    }

    #wysiwyg-content .task-item input[type="checkbox"] {
      margin-right: 0.5em;
      margin-top: 0.1em;
      cursor: pointer;
    }

    #wysiwyg-content .task-text {
      flex: 1;
      transition: text-decoration 0.2s ease;
    }

    /* ãƒ„ãƒ¼ãƒ«ãƒãƒ¼ã‚»ãƒ¬ã‚¯ãƒˆã®ã‚¹ã‚¿ã‚¤ãƒ« */
    .toolbar-select {
      padding: 6px 8px;
      border: 1px solid #dee2e6;
      border-radius: 3px;
      font-size: 14px;
      cursor: pointer;
    }

    /* ã‚½ãƒ¼ã‚¹ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼ã®ã‚¹ã‚¿ã‚¤ãƒ« */
    #source-editor {
      display: none;
      width: 100%;
      height: 100%;
      padding: 20px;
      font-family: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, monospace;
      font-size: 14px;
      line-height: 1.6;
      border: none;
      outline: none;
      resize: none;
    }

    /* ãƒ¢ãƒ¼ãƒ€ãƒ«é–¢é€£ã®ã‚¹ã‚¿ã‚¤ãƒ« */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.5);
      z-index: 9999;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .modal-content {
      background: white;
      padding: 30px;
      border-radius: 8px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.3);
      max-width: 600px;
      max-height: 80vh;
      overflow-y: auto;
      position: relative;
    }

    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      padding-bottom: 10px;
      border-bottom: 1px solid #dee2e6;
    }

    .modal-title {
      margin: 0;
      color: #333;
    }

    .modal-close {
      background: none;
      border: none;
      font-size: 24px;
      cursor: pointer;
      color: #6c757d;
      padding: 0;
      width: 30px;
      height: 30px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* ç·¨é›†ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ç”¨ã®ã‚¹ã‚¿ã‚¤ãƒ« */
    .edit-dialog-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.5);
      z-index: 10000;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .edit-dialog-content {
      background: white;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.3);
      max-width: 400px;
      width: 90%;
    }

    .edit-dialog-title {
      margin: 0 0 15px 0;
      color: #333;
    }

    .edit-dialog-field {
      margin-bottom: 10px;
    }

    .edit-dialog-field:last-of-type {
      margin-bottom: 15px;
    }

    .edit-dialog-label {
      display: block;
      margin-bottom: 5px;
      font-weight: bold;
      color: #555;
    }

    .edit-dialog-input {
      width: 100%;
      padding: 8px;
      border: 1px solid #ddd;
      border-radius: 4px;
      box-sizing: border-box;
    }

    .edit-dialog-buttons {
      text-align: right;
    }

    .edit-dialog-btn {
      padding: 8px 16px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 14px;
    }

    .edit-dialog-btn-cancel {
      margin-right: 10px;
      border: 1px solid #ddd;
      background: #f5f5f5;
      color: #333;
    }

    .edit-dialog-btn-ok {
      border: none;
      background: #007cba;
      color: white;
    }

    .status-bar {
      background: #f8f9fa;
      border-top: 1px solid #dee2e6;
      padding: 8px 16px;
      font-size: 12px;
      color: #6c757d;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .ai-loading-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 10000;
    }

    .ai-loading-content {
      background: white;
      padding: 30px;
      border-radius: 8px;
      text-align: center;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
    }

    .ai-spinner {
      width: 40px;
      height: 40px;
      border: 4px solid #f3f3f3;
      border-top: 4px solid #007bff;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin: 0 auto 15px;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    /* AIè¨­å®šãƒ¢ãƒ¼ãƒ€ãƒ« */
    .ai-settings-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 10001;
    }

    .ai-settings-panel {
      background: white;
      border-radius: 8px;
      padding: 24px;
      width: 500px;
      max-width: 90vw;
      max-height: 80vh;
      overflow-y: auto;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
    }

    .ai-settings-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      padding-bottom: 10px;
      border-bottom: 1px solid #dee2e6;
    }

    .ai-settings-content label {
      display: block;
      margin-bottom: 5px;
      font-weight: 500;
      color: #333;
    }

    .ai-settings-content select,
    .ai-settings-content input {
      width: 100%;
      padding: 8px 12px;
      border: 1px solid #dee2e6;
      border-radius: 4px;
      font-size: 14px;
      margin-bottom: 15px;
    }

    .ai-settings-content small {
      color: #6c757d;
      font-size: 12px;
    }

    .ai-settings-content a {
      color: #007bff;
      text-decoration: none;
    }

    .ai-settings-content a:hover {
      text-decoration: underline;
    }

    .ai-settings-actions {
      display: flex;
      justify-content: flex-end;
      gap: 10px;
      margin-top: 20px;
      padding-top: 15px;
      border-top: 1px solid #dee2e6;
    }

    .close-btn {
      background: none;
      border: none;
      font-size: 24px;
      cursor: pointer;
      color: #6c757d;
      padding: 0;
      width: 30px;
      height: 30px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .close-btn:hover {
      color: #333;
    }

    /* AIçµæœãƒ¢ãƒ¼ãƒ€ãƒ« */
    .ai-result-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 10002;
    }

    .ai-result-panel {
      background: white;
      border-radius: 8px;
      padding: 24px;
      width: 700px;
      max-width: 90vw;
      max-height: 80vh;
      display: flex;
      flex-direction: column;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
    }

    .ai-result-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      padding-bottom: 10px;
      border-bottom: 1px solid #dee2e6;
    }

    .ai-result-content {
      flex: 1;
      overflow-y: auto;
      background: #f8f9fa;
      border: 1px solid #dee2e6;
      border-radius: 4px;
      padding: 16px;
      margin-bottom: 20px;
      line-height: 1.6;
    }

    .ai-result-actions {
      display: flex;
      justify-content: flex-end;
      gap: 10px;
    }

    .secondary {
      background: #6c757d;
      border-color: #6c757d;
    }

    .secondary:hover {
      background: #5a6268;
      border-color: #545b62;
    }

    /* æ¤œç´¢ãƒ»ç½®æ›ãƒ€ã‚¤ã‚¢ãƒ­ã‚° */
    .search-replace-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 10005;
    }

    .search-replace-dialog {
      background: white;
      border-radius: 8px;
      padding: 24px;
      width: 500px;
      max-width: 90vw;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
    }

    .search-replace-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      padding-bottom: 10px;
      border-bottom: 1px solid #dee2e6;
    }

    .search-replace-title {
      margin: 0;
      color: #333;
      font-size: 18px;
    }

    .search-replace-close {
      background: none;
      border: none;
      font-size: 24px;
      cursor: pointer;
      color: #6c757d;
      padding: 0;
      width: 30px;
      height: 30px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .search-replace-close:hover {
      color: #333;
    }

    .search-replace-form {
      display: flex;
      flex-direction: column;
      gap: 15px;
    }

    .search-field-group {
      display: flex;
      flex-direction: column;
      gap: 5px;
    }

    .search-field-label {
      font-size: 14px;
      font-weight: 500;
      color: #333;
    }

    .search-input-wrapper {
      position: relative;
      display: flex;
      align-items: center;
    }

    .search-input {
      flex: 1;
      padding: 8px 12px;
      border: 1px solid #dee2e6;
      border-radius: 4px;
      font-size: 14px;
      outline: none;
    }

    .search-input:focus {
      border-color: #007bff;
      box-shadow: 0 0 0 2px rgba(0, 123, 255, 0.25);
    }

    .search-count {
      position: absolute;
      right: 10px;
      font-size: 12px;
      color: #6c757d;
      background: #f8f9fa;
      padding: 2px 6px;
      border-radius: 3px;
    }

    .search-options {
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
      margin: 10px 0;
    }

    .search-checkbox-group {
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .search-checkbox {
      margin: 0;
    }

    .search-checkbox-label {
      font-size: 14px;
      color: #333;
      cursor: pointer;
      user-select: none;
    }

    .search-actions {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 20px;
      padding-top: 15px;
      border-top: 1px solid #dee2e6;
    }

    .search-navigation {
      display: flex;
      gap: 8px;
    }

    .search-nav-btn {
      padding: 8px 12px;
      border: 1px solid #dee2e6;
      border-radius: 4px;
      background: white;
      color: #333;
      cursor: pointer;
      font-size: 14px;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      gap: 4px;
    }

    .search-nav-btn:hover {
      background: #f8f9fa;
      border-color: #adb5bd;
    }

    .search-nav-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .search-main-actions {
      display: flex;
      gap: 10px;
    }

    .search-btn {
      padding: 8px 16px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 14px;
      border: none;
      transition: all 0.2s;
    }

    .search-btn-secondary {
      background: #6c757d;
      color: white;
    }

    .search-btn-secondary:hover {
      background: #5a6268;
    }

    .search-btn-danger {
      background: #dc3545;
      color: white;
    }

    .search-btn-danger:hover {
      background: #c82333;
    }

    .search-btn-primary {
      background: #007bff;
      color: white;
    }

    .search-btn-primary:hover {
      background: #0056b3;
    }

    /* æ¤œç´¢çµæœã®ãƒã‚¤ãƒ©ã‚¤ãƒˆ */
    .search-highlight {
      background: #fff3cd;
      border: 1px solid #ffeaa7;
      border-radius: 2px;
      padding: 1px 2px;
    }

    .search-highlight.current {
      background: #007bff;
      color: white;
      border-color: #0056b3;
    }

    @media (max-width: 768px) {
      .header {
        padding: 8px 12px;
      }
      
      .logo-icon {
        font-size: 20px;
      }
      
      .file-info {
        max-width: 150px;
        padding: 3px 10px;
      }
      
      .file-name {
        max-width: 120px;
        font-size: 12px;
      }
      
      .btn {
        width: 32px;
        height: 32px;
        font-size: 16px;
      }
      
      .header-controls {
        gap: 2px;
      }
      
      .btn-tooltip {
        display: none;
      }

      .main-container {
        flex-direction: column;
      }

      .editor-container {
        margin: 10px;
      }

      .toolbar {
        flex-wrap: wrap;
      }

      .search-replace-dialog {
        width: 95vw;
        padding: 20px;
      }

      .search-options {
        flex-direction: column;
        gap: 10px;
      }

      .search-actions {
        flex-direction: column;
        gap: 15px;
        align-items: stretch;
      }

      .search-navigation {
        justify-content: center;
      }
    }

    /* ç”»åƒæŒ¿å…¥ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã®ã‚¹ã‚¿ã‚¤ãƒ« */
    .image-insert-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      z-index: 1000;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }

    .image-insert-dialog {
      background: white;
      border-radius: 12px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      width: 90%;
      max-width: 600px;
      max-height: 80%;
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }

    .dialog-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 20px 24px;
      border-bottom: 1px solid #e0e0e0;
      background: #f8f9fa;
    }

    .dialog-header h3 {
      margin: 0;
      font-size: 18px;
      font-weight: 600;
      color: #333;
    }

    .close-btn {
      background: none;
      border: none;
      font-size: 20px;
      cursor: pointer;
      padding: 4px 8px;
      border-radius: 4px;
      color: #666;
    }

    .close-btn:hover {
      background: #e9ecef;
      color: #333;
    }

    .dialog-content {
      flex: 1;
      padding: 24px;
      overflow-y: auto;
    }

    .insert-method-tabs {
      display: flex;
      gap: 4px;
      margin-bottom: 20px;
      border-bottom: 1px solid #e0e0e0;
    }

    .method-tab {
      background: none;
      border: none;
      padding: 12px 20px;
      cursor: pointer;
      font-size: 14px;
      font-weight: 500;
      color: #666;
      border-bottom: 2px solid transparent;
      transition: all 0.2s ease;
    }

    .method-tab:hover {
      color: #333;
      background: #f8f9fa;
    }

    .method-tab.active {
      color: #0066cc;
      border-bottom-color: #0066cc;
      background: #f0f8ff;
    }

    .insert-method-content {
      position: relative;
    }

    .method-panel {
      display: none;
    }

    .method-panel.active {
      display: block;
    }

    .form-group {
      margin-bottom: 16px;
    }

    .form-group label {
      display: block;
      margin-bottom: 6px;
      font-weight: 500;
      color: #333;
    }

    .form-input {
      width: 100%;
      padding: 10px 12px;
      border: 2px solid #e0e0e0;
      border-radius: 6px;
      font-size: 14px;
      transition: border-color 0.2s ease;
    }

    .form-input:focus {
      outline: none;
      border-color: #0066cc;
    }

    .drive-selection-area {
      text-align: center;
      padding: 40px 20px;
    }

    .drive-status {
      margin-bottom: 20px;
    }

    .status-checking,
    .status-success,
    .status-warning,
    .status-error {
      padding: 12px 16px;
      border-radius: 6px;
      font-size: 14px;
      line-height: 1.5;
    }

    .status-success {
      background: #e8f5e9;
      color: #2e7d32;
    }

    .status-warning {
      background: #fff3e0;
      color: #f57c00;
    }

    .status-error {
      background: #ffebee;
      color: #d32f2f;
    }

    .status-checking {
      background: #f3e5f5;
      color: #7b1fa2;
    }

    .selected-drive-file {
      display: none;
      align-items: center;
      gap: 16px;
      padding: 16px;
      border: 2px solid #e0e0e0;
      border-radius: 8px;
      background: #f8f9fa;
    }

    .file-preview-small {
      width: 48px;
      height: 48px;
      border-radius: 6px;
      overflow: hidden;
      background: white;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
    }

    .file-preview-small img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .file-info-small {
      flex: 1;
      text-align: left;
    }

    .file-info-small .file-name {
      font-weight: 500;
      color: #333;
      margin-bottom: 2px;
    }

    .file-info-small .file-meta {
      font-size: 12px;
      color: #666;
    }

    .dialog-footer {
      display: flex;
      justify-content: flex-end;
      gap: 12px;
      padding: 20px 24px;
      border-top: 1px solid #e0e0e0;
      background: white;
    }

    .btn {
      padding: 10px 20px;
      border-radius: 6px;
      border: none;
      cursor: pointer;
      font-size: 14px;
      font-weight: 500;
      transition: all 0.2s ease;
    }

    .btn-secondary {
      background: #f5f5f5;
      color: #333;
      border: 1px solid #ddd;
    }

    .btn-secondary:hover {
      background: #e9ecef;
    }

    .btn-primary {
      background: #0066cc;
      color: white;
    }

    .btn-primary:hover:not(:disabled) {
      background: #0052a3;
    }

    .btn-primary:disabled {
      background: #ccc;
      cursor: not-allowed;
    }

    .btn-small {
      padding: 6px 12px;
      font-size: 12px;
    }

    @media (max-width: 768px) {
      .image-insert-dialog {
        width: 95%;
        margin: 10px;
      }
      
      .dialog-content {
        padding: 16px;
      }
      
      .insert-method-tabs {
        flex-direction: column;
        gap: 0;
      }
      
      .method-tab {
        text-align: left;
        border-bottom: 1px solid #e0e0e0;
        border-radius: 0;
      }
      
      .selected-drive-file {
        flex-direction: column;
        text-align: center;
      }
    }
  </style>
</head>
<body>
  <div class="header">
    <div class="logo">
      <span class="logo-icon" title="SightEdit">ğŸ‘ï¸</span>
      <div class="file-info">
        <span class="file-label">ãƒ•ã‚¡ã‚¤ãƒ«:</span>
        <span id="current-file-name" class="file-name" title="ã‚¯ãƒªãƒƒã‚¯ã—ã¦åå‰ã‚’å¤‰æ›´">ç„¡é¡Œ</span>
        <span id="file-modified-indicator" class="modified-indicator" style="display: none;">â—</span>
      </div>
    </div>
    <div class="header-controls">
      <button class="btn" id="new-file-btn" title="æ–°è¦ãƒ•ã‚¡ã‚¤ãƒ«">ğŸ“„<span class="btn-tooltip">æ–°è¦</span></button>
      <button class="btn" id="open-file-btn" title="ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ã">ğŸ“‚<span class="btn-tooltip">é–‹ã</span></button>
      <button class="btn" id="save-file-btn" title="ä¿å­˜">ğŸ’¾<span class="btn-tooltip">ä¿å­˜</span></button>
      <button class="btn" id="save-as-btn" title="åå‰ã‚’ä»˜ã‘ã¦ä¿å­˜">ğŸ“<span class="btn-tooltip">åˆ¥åä¿å­˜</span></button>
      <button class="btn" id="export-btn" title="ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ">ğŸ“¤<span class="btn-tooltip">ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ</span></button>
      <button class="btn" id="settings-btn" title="è¨­å®š">âš™ï¸<span class="btn-tooltip">è¨­å®š</span></button>
    </div>
  </div>

  <div class="main-container">
    <div class="editor-container">
      <div class="toolbar">
        <div class="toolbar-group">
          <button class="toolbar-btn" data-action="bold" title="å¤ªå­—"><strong>B</strong></button>
          <button class="toolbar-btn" data-action="italic" title="æ–œä½“"><em>I</em></button>
          <button class="toolbar-btn" data-action="strike" title="å–ã‚Šæ¶ˆã—ç·š"><s>S</s></button>
          <button class="toolbar-btn" data-action="code" title="ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ã‚³ãƒ¼ãƒ‰">&lt;/&gt;</button>
        </div>

        <div class="toolbar-group">
          <select id="heading-select" class="toolbar-select">
            <option value="">è¦‹å‡ºã—</option>
            <option value="1">H1 - å¤§è¦‹å‡ºã—</option>
            <option value="2">H2 - ä¸­è¦‹å‡ºã—</option>
            <option value="3">H3 - å°è¦‹å‡ºã—</option>
            <option value="4">H4 - å°è¦‹å‡ºã—4</option>
            <option value="5">H5 - å°è¦‹å‡ºã—5</option>
            <option value="6">H6 - å°è¦‹å‡ºã—6</option>
            <option value="p">æ®µè½</option>
          </select>
        </div>

        <div class="toolbar-group">
          <button class="toolbar-btn" data-action="bulletList" title="ç®‡æ¡æ›¸ããƒªã‚¹ãƒˆ">â€¢ ãƒªã‚¹ãƒˆ</button>
          <button class="toolbar-btn" data-action="orderedList" title="ç•ªå·ä»˜ããƒªã‚¹ãƒˆ">1. ãƒªã‚¹ãƒˆ</button>
          <button class="toolbar-btn" data-action="blockquote" title="å¼•ç”¨">â å¼•ç”¨</button>
        </div>

        <div class="toolbar-group">
          <button class="toolbar-btn" data-action="codeBlock" title="ã‚³ãƒ¼ãƒ‰ãƒ–ãƒ­ãƒƒã‚¯">{ } ã‚³ãƒ¼ãƒ‰</button>
          <button class="toolbar-btn" data-action="horizontalRule" title="æ°´å¹³ç·š">â€” æ°´å¹³ç·š</button>
        </div>

        <div class="toolbar-group">
          <button class="toolbar-btn" data-action="link" title="ãƒªãƒ³ã‚¯">ğŸ”— ãƒªãƒ³ã‚¯</button>
          <button class="toolbar-btn" data-action="image" title="ç”»åƒ">ğŸ–¼ï¸ ç”»åƒ</button>
          <button class="toolbar-btn" data-action="table" title="è¡¨">ğŸ“¦ è¡¨</button>
        </div>

        <div class="toolbar-group">
          <button class="toolbar-btn" data-action="undo" title="å…ƒã«æˆ»ã™">â†¶</button>
          <button class="toolbar-btn" data-action="redo" title="ã‚„ã‚Šç›´ã—">â†·</button>
        </div>

        <div class="toolbar-group">
          <button class="toolbar-btn" id="search-replace-btn" title="æ¤œç´¢ã¨ç½®æ› (Ctrl+F)">ğŸ” æ¤œç´¢</button>
        </div>

        <div class="toolbar-group">
          <button class="toolbar-btn" id="ai-command-btn" title="AIã‚³ãƒãƒ³ãƒ‰">ğŸ¤– AI</button>
          <!-- Subagentsæ©Ÿèƒ½ã¯å‰Šé™¤æ¸ˆã¿ -->
          <button class="toolbar-btn" id="diagram-btn" title="å›³è¡¨ç”Ÿæˆ">ğŸ“Š å›³è¡¨</button>
          <button class="toolbar-btn" id="chat-toggle-btn" title="AIãƒãƒ£ãƒƒãƒˆ (Ctrl+K)">ğŸ’¬ Chat</button>
          <button class="toolbar-btn" id="toggle-mode-btn" title="WYSIWYG/ã‚½ãƒ¼ã‚¹åˆ‡ã‚Šæ›¿ãˆ">ğŸ”„ ãƒ¢ãƒ¼ãƒ‰</button>
          <button class="toolbar-btn" id="toc-btn" title="ç›®æ¬¡ç”Ÿæˆ">ğŸ“‹ ç›®æ¬¡</button>
          <button class="toolbar-btn" id="help-btn" title="ãƒ˜ãƒ«ãƒ—">â“ ãƒ˜ãƒ«ãƒ—</button>
        </div>
      </div>

      <div class="editor-content" id="editor"></div>

      <div class="status-bar">
        <span id="word-count">æ–‡å­—æ•°: 0</span>
        <span id="editor-mode">WYSIWYG ãƒ¢ãƒ¼ãƒ‰</span>
      </div>

      <!-- ã‚½ãƒ¼ã‚¹ãƒ¢ãƒ¼ãƒ‰ç”¨ã®textareaï¼ˆéè¡¨ç¤ºï¼‰ -->
      <textarea id="source-editor"></textarea>
    </div>
  </div>

  <!-- AIã‚³ãƒãƒ³ãƒ‰ãƒ‘ãƒãƒ«ãƒ¢ãƒ¼ãƒ€ãƒ« -->
  <div id="ai-command-modal" class="ai-command-modal" style="display: none;">
    <div class="ai-command-container">
      <div class="ai-command-header">
        <div class="ai-command-title">
          <span class="ai-command-title-icon">ğŸ¤–</span>
          AIã‚³ãƒãƒ³ãƒ‰é¸æŠ
        </div>
        <button class="ai-command-close" id="ai-command-close">Ã—</button>
      </div>
      <div class="ai-command-body">
        <div class="selected-text-preview" id="selected-text-preview" style="display: none;">
          <div class="selected-text-label">é¸æŠã•ã‚ŒãŸãƒ†ã‚­ã‚¹ãƒˆ</div>
          <div class="selected-text-content" id="selected-text-content"></div>
        </div>
        <div id="ai-command-panel-content">
          <!-- AIã‚³ãƒãƒ³ãƒ‰ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ã«ã‚ˆã£ã¦å‹•çš„ã«ç”Ÿæˆã•ã‚Œã‚‹ -->
        </div>
      </div>
      <div class="ai-command-loading" id="ai-command-loading" style="display: none;">
        <div class="ai-command-spinner"></div>
      </div>
    </div>
  </div>

  <!-- å…¥åŠ›ãƒ€ã‚¤ã‚¢ãƒ­ã‚° -->
  <div id="command-input-dialog" class="command-input-dialog" style="display: none;">
    <div class="command-input-title" id="command-input-title">ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å…¥åŠ›</div>
    <input type="text" class="command-input-field" id="command-input-field" placeholder="å€¤ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„">
    <div class="command-input-buttons">
      <button class="command-input-cancel" id="command-input-cancel">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
      <button class="command-input-confirm" id="command-input-confirm">å®Ÿè¡Œ</button>
    </div>
  </div>

  <!-- AIè¨­å®šãƒ€ã‚¤ã‚¢ãƒ­ã‚° -->
  <div id="ai-settings-modal" class="ai-settings-modal" style="display: none;">
    <div class="ai-settings-container">
      <div class="ai-settings-header">
        <h3>ğŸ¤– AIè¨­å®š</h3>
        <button class="ai-settings-close" id="ai-settings-close">Ã—</button>
      </div>
      <div class="ai-settings-body">
        <div class="ai-settings-section">
          <h4>ğŸ”‘ APIã‚­ãƒ¼è¨­å®š</h4>
          <div class="ai-provider-tabs">
            <button class="ai-tab-btn active" data-provider="gemini">Gemini API</button>
            <button class="ai-tab-btn" data-provider="claude">Claude API</button>
          </div>
          
          <!-- Geminiè¨­å®š -->
          <div class="ai-provider-panel active" id="gemini-panel">
            <div class="form-group">
              <label for="gemini-api-key">Gemini APIã‚­ãƒ¼:</label>
              <input type="text" id="gemini-api-key" class="api-key-input" placeholder="AIzaSy...">
              <button type="button" class="toggle-password" data-target="gemini-api-key">ğŸ‘ï¸</button>
            </div>
            <div class="form-group">
              <label for="gemini-model">ãƒ¢ãƒ‡ãƒ«é¸æŠ:</label>
              <select id="gemini-model" class="ai-form-select">
                <option value="gemini-2.0-flash-exp">Gemini 2.0 Flash (å®Ÿé¨“ç‰ˆãƒ»æœ€æ–°ãƒ»ç„¡æ–™æ ã‚ã‚Š)</option>
                <option value="gemini-2.0-flash">Gemini 2.0 Flash (ç„¡æ–™æ ã‚ã‚Š)</option>
                <option value="gemini-2.5-pro" selected>Gemini 2.5 Pro (ç„¡æ–™æ ã‚ã‚Šãƒ»æ¨å¥¨)</option>
                <option value="gemini-1.5-flash">Gemini 1.5 Flash (ç„¡æ–™æ ã‚ã‚Šãƒ»é«˜é€Ÿ)</option>
                <option value="gemini-1.5-pro">Gemini 1.5 Pro (ç„¡æ–™æ ã‚ã‚Š)</option>
              </select>
            </div>
          </div>

          <!-- Claudeè¨­å®š -->
          <div class="ai-provider-panel" id="claude-panel">
            <div class="form-group">
              <p class="ai-info-text">âœ¨ Claude Sonnet 4ã¯èªè¨¼ä¸è¦ã§ä½¿ç”¨ã§ãã¾ã™ï¼ˆArtifactså¯¾å¿œï¼‰</p>
            </div>
            <div class="form-group">
              <label for="claude-model">ãƒ¢ãƒ‡ãƒ«é¸æŠ:</label>
              <select id="claude-model" class="ai-form-select">
                <option value="claude-sonnet-4-20250514" selected>Claude Sonnet 4 (Artifactså¯¾å¿œ)</option>
              </select>
            </div>
          </div>

          <div class="form-group">
            <label for="default-provider">æ—¢å®šã®AIãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼:</label>
            <select id="default-provider" class="provider-select">
              <option value="gemini">Gemini (Google)</option>
              <option value="claude">Claude (Anthropic)</option>
            </select>
          </div>
        </div>

        <div class="ai-settings-section">
          <h4>â„¹ï¸ å–å¾—æ–¹æ³•</h4>
          <div class="api-info">
            <div class="api-info-item">
              <strong>Gemini API:</strong>
              <a href="https://aistudio.google.com/app/apikey" target="_blank">Google AI Studio</a>
              ã§ç„¡æ–™å–å¾—å¯èƒ½
            </div>
            <div class="api-info-item">
              <strong>Claude:</strong>
              Claude Sonnet 4ã¯èªè¨¼ä¸è¦ï¼ˆArtifactså¯¾å¿œï¼‰
            </div>
          </div>
        </div>

        <div class="ai-settings-actions">
          <button class="ai-settings-test" id="ai-settings-test">ğŸ§ª æ¥ç¶šãƒ†ã‚¹ãƒˆ</button>
          <button class="ai-settings-save" id="ai-settings-save">ğŸ’¾ è¨­å®šä¿å­˜</button>
        </div>
      </div>
    </div>
  </div>

  <!-- ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆãƒ¡ãƒ‹ãƒ¥ãƒ¼ -->
  <div id="export-menu" class="export-menu" style="display: none;">
    <div class="export-menu-container">
      <div class="export-menu-header">
        <h3>ğŸ“¤ ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆãƒ»ã‚³ãƒ”ãƒ¼</h3>
        <button class="export-menu-close" id="export-menu-close">Ã—</button>
      </div>
      <div class="export-menu-body">
        <div class="export-section">
          <h4>ğŸ“‹ ã‚µãƒ¼ãƒ“ã‚¹åˆ¥ã‚³ãƒ”ãƒ¼&ãƒšãƒ¼ã‚¹ãƒˆ</h4>
          <p class="export-section-desc">å„ã‚µãƒ¼ãƒ“ã‚¹ã«æœ€é©åŒ–ã•ã‚ŒãŸãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã§ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼</p>
          <div class="export-buttons" id="clipboard-buttons">
            <!-- JavaScript ã§å‹•çš„ç”Ÿæˆ -->
          </div>
        </div>
        <div class="export-section">
          <h4>ğŸ’¾ ãƒ•ã‚¡ã‚¤ãƒ«ä¿å­˜</h4>
          <p class="export-section-desc">å„ç¨®ãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼ã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ä¿å­˜</p>
          <div class="export-buttons" id="download-buttons">
            <!-- JavaScript ã§å‹•çš„ç”Ÿæˆ -->
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- è¨­å®šãƒ€ã‚¤ã‚¢ãƒ­ã‚° -->
  <div id="settings-overlay" class="settings-overlay" style="display: none;">
    <div class="settings-dialog">
      <div class="settings-header">
        <h3>âš™ï¸ è¨­å®š</h3>
        <button id="settings-close" class="settings-close">&times;</button>
      </div>
      <div class="settings-body">
        
        <!-- è¨­å®šã‚«ãƒ†ã‚´ãƒªãƒ¼ã‚¿ãƒ– -->
        <div class="settings-tabs">
          <button class="settings-tab active" data-tab="ai">
            <span>ğŸ¤– AIè¨­å®š</span>
          </button>
          <button class="settings-tab" data-tab="editor">
            <span>ğŸ“ ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼</span>
          </button>
          <button class="settings-tab" data-tab="export">
            <span>ğŸ“¤ ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ</span>
          </button>
        </div>

        <!-- AIè¨­å®šã‚¿ãƒ– -->
        <div id="ai-tab" class="settings-tab-content active">
          <h4>AIè¨­å®š</h4>
          
          <!-- ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã‚¿ãƒ– -->
          <div class="ai-provider-tabs">
            <button class="ai-provider-tab active" data-provider="gemini">
              <span>ğŸ§  Gemini</span>
            </button>
            <button class="ai-provider-tab" data-provider="claude">
              <span>ğŸ¤– Claude</span>
            </button>
          </div>

          <!-- Geminiè¨­å®š -->
          <div id="gemini-settings" class="ai-provider-content active">
            <div class="ai-api-info">
              <h4>Google Gemini API</h4>
              <p>Google AI Studio ã§APIã‚­ãƒ¼ã‚’å–å¾—ã—ã¦ãã ã•ã„ã€‚ç„¡æ–™æ ãŒåˆ©ç”¨å¯èƒ½ã§ã™ã€‚</p>
              <a href="https://aistudio.google.com/app/apikey" target="_blank" class="ai-api-link">
                APIã‚­ãƒ¼ã‚’å–å¾— â†—ï¸
              </a>
            </div>
            
            <div class="ai-form-group">
              <label for="gemini-api-key" class="ai-form-label">APIã‚­ãƒ¼:</label>
              <div class="ai-password-group">
                <input type="text" id="gemini-api-key" class="ai-form-input" placeholder="Gemini APIã‚­ãƒ¼ã‚’å…¥åŠ›">
                <button type="button" id="gemini-password-toggle" class="ai-password-toggle">ğŸ‘ï¸</button>
              </div>
            </div>
            
            <div class="ai-form-group">
              <label for="gemini-model" class="ai-form-label">ãƒ¢ãƒ‡ãƒ«é¸æŠ:</label>
              <select id="gemini-model" class="ai-form-select">
                <option value="gemini-2.0-flash-exp">Gemini 2.0 Flash (å®Ÿé¨“ç‰ˆãƒ»æœ€æ–°ãƒ»ç„¡æ–™æ ã‚ã‚Š)</option>
                <option value="gemini-2.0-flash">Gemini 2.0 Flash (ç„¡æ–™æ ã‚ã‚Š)</option>
                <option value="gemini-2.5-pro" selected>Gemini 2.5 Pro (ç„¡æ–™æ ã‚ã‚Šãƒ»æ¨å¥¨)</option>
                <option value="gemini-1.5-flash">Gemini 1.5 Flash (ç„¡æ–™æ ã‚ã‚Šãƒ»é«˜é€Ÿ)</option>
                <option value="gemini-1.5-pro">Gemini 1.5 Pro (ç„¡æ–™æ ã‚ã‚Š)</option>
              </select>
            </div>
            
            <button id="gemini-test-btn" class="ai-button ai-button-secondary ai-test-button">
              ğŸ” æ¥ç¶šãƒ†ã‚¹ãƒˆ
            </button>
          </div>

          <!-- Claudeè¨­å®š -->
          <div id="claude-settings" class="ai-provider-content">
            <div class="ai-api-info">
              <h4>Anthropic Claude</h4>
              <p>Claude.aiã®Artifactsæ©Ÿèƒ½ã¨ã®äº’æ›æ€§å¯¾å¿œã€‚èªè¨¼ä¸è¦ã§ä½¿ç”¨ã§ãã¾ã™ã€‚</p>
            </div>

            <div class="ai-form-group">
              <label for="claude-model" class="ai-form-label">ãƒ¢ãƒ‡ãƒ«é¸æŠ:</label>
              <select id="claude-model" class="ai-form-select">
                <option value="claude-sonnet-4-20250514" selected>Claude Sonnet 4 (Artifactså¯¾å¿œ)</option>
              </select>
            </div>

            <p class="ai-info-text">âœ¨ Claude Sonnet 4ãƒ¢ãƒ‡ãƒ«ã¯ã€Claude.aiã®Artifactsæ©Ÿèƒ½ã¨ã®äº’æ›æ€§ã‚’æŒã¡ã€èªè¨¼ãªã—ã§ä½¿ç”¨ã§ãã¾ã™ã€‚</p>
          </div>
        </div>

        <!-- ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼è¨­å®šã‚¿ãƒ– -->
        <div id="editor-tab" class="settings-tab-content">
          <h4>ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼è¨­å®š</h4>
          <p>ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼ã®å‹•ä½œè¨­å®šï¼ˆä»Šå¾Œå®Ÿè£…äºˆå®šï¼‰</p>
          
          <div class="settings-form-group">
            <label>
              <input type="checkbox" id="auto-save" checked>
              è‡ªå‹•ä¿å­˜ã‚’æœ‰åŠ¹ã«ã™ã‚‹
            </label>
          </div>
          
          <div class="settings-form-group">
            <label>
              <input type="checkbox" id="word-wrap" checked>
              è¡Œã®æŠ˜ã‚Šè¿”ã—ã‚’æœ‰åŠ¹ã«ã™ã‚‹
            </label>
          </div>
        </div>

        <!-- ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆè¨­å®šã‚¿ãƒ– -->
        <div id="export-tab" class="settings-tab-content">
          <h4>ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆè¨­å®š</h4>
          <p>ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆæ©Ÿèƒ½ã®è¨­å®šï¼ˆä»Šå¾Œå®Ÿè£…äºˆå®šï¼‰</p>
          
          <div class="settings-form-group">
            <label for="default-export-format">ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆå½¢å¼:</label>
            <select id="default-export-format" class="settings-form-select">
              <option value="markdown">Markdown</option>
              <option value="html">HTML</option>
              <option value="pdf">PDF</option>
            </select>
          </div>
        </div>

        <!-- ä¿å­˜ãƒœã‚¿ãƒ³ -->
        <div class="settings-button-group">
          <button id="settings-save" class="settings-button settings-button-primary">
            ğŸ’¾ è¨­å®šã‚’ä¿å­˜
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- å›³è¡¨ç”Ÿæˆãƒ¢ãƒ¼ãƒ€ãƒ« -->
  <div id="diagram-modal" class="diagram-modal" style="display: none;">
    <div class="diagram-container">
      <div class="diagram-header">
        <h3 class="diagram-title">ğŸ“Š AIå›³è¡¨ç”Ÿæˆ</h3>
        <button class="diagram-close" id="diagram-close">Ã—</button>
      </div>
      
      <div class="diagram-body">
        <!-- å›³è¡¨ã‚¿ã‚¤ãƒ—é¸æŠ -->
        <div class="diagram-types">
          <h4>å›³è¡¨ã‚¿ã‚¤ãƒ—ã‚’é¸æŠ:</h4>
          <div class="diagram-type-grid" id="diagram-type-grid">
            <!-- ã“ã“ã«å‹•çš„ã«ãƒœã‚¿ãƒ³ãŒç”Ÿæˆã•ã‚Œã‚‹ -->
          </div>
        </div>
        
        <!-- å…¥åŠ›ã‚¨ãƒªã‚¢ -->
        <div class="diagram-input-section">
          <label for="diagram-description">èª¬æ˜ï¼ˆè‡ªç„¶è¨€èªã§å…¥åŠ›ï¼‰:</label>
          <textarea 
            id="diagram-description" 
            class="diagram-description"
            rows="3"
            placeholder="ä¾‹ï¼šãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²ã®ãƒ•ãƒ­ãƒ¼ã‚’è¡¨ã™ãƒ•ãƒ­ãƒ¼ãƒãƒ£ãƒ¼ãƒˆ"
          ></textarea>
        </div>
        
        <!-- ã‚µã‚¤ã‚ºè¨­å®š -->
        <div class="diagram-size-section">
          <h4>ã‚µã‚¤ã‚ºè¨­å®š:</h4>
          <div class="diagram-size-inputs">
            <div class="size-input-group">
              <label for="diagram-width">å¹…:</label>
              <input type="number" id="diagram-width" value="800" min="200" max="2000" step="50">
              <span>px</span>
            </div>
            <div class="size-input-group">
              <label for="diagram-height">é«˜ã•:</label>
              <input type="number" id="diagram-height" value="600" min="200" max="2000" step="50">
              <span>px</span>
            </div>
          </div>
        </div>
        
        <!-- ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚¨ãƒªã‚¢ -->
        <div class="diagram-preview-section" style="display: none;">
          <h4>ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼:</h4>
          <div id="diagram-preview" class="diagram-preview"></div>
        </div>
        
        <!-- ãƒœã‚¿ãƒ³ -->
        <div class="diagram-buttons">
          <button id="diagram-generate" class="diagram-btn diagram-btn-primary">ğŸ¨ ç”Ÿæˆ</button>
          <button id="diagram-insert" class="diagram-btn" style="display: none;">ğŸ“ æŒ¿å…¥</button>
          <button id="diagram-copy" class="diagram-btn" style="display: none;">ğŸ“‹ ã‚³ãƒ”ãƒ¼</button>
          <button id="diagram-export" class="diagram-btn" style="display: none;">ğŸ’¾ ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ</button>
        </div>
      </div>
      
      <div class="diagram-loading" id="diagram-loading" style="display: none;">
        <div class="diagram-spinner"></div>
        <p>å›³è¡¨ã‚’ç”Ÿæˆä¸­...</p>
      </div>
    </div>
  </div>

  <!-- å›³è¡¨ç”Ÿæˆç”¨ã®ã‚¹ã‚¿ã‚¤ãƒ« -->
  <style>
    .diagram-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 10000;
    }
    
    .diagram-container {
      background: white;
      border-radius: 12px;
      width: 90%;
      max-width: 900px;
      max-height: 90vh;
      overflow-y: auto;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
      position: relative;
    }
    
    .diagram-header {
      padding: 20px;
      border-bottom: 1px solid #e0e0e0;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .diagram-title {
      margin: 0;
      font-size: 20px;
      color: #333;
    }
    
    .diagram-close {
      background: none;
      border: none;
      font-size: 24px;
      cursor: pointer;
      color: #999;
      padding: 0;
      width: 32px;
      height: 32px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
      transition: all 0.2s;
    }
    
    .diagram-close:hover {
      background: #f0f0f0;
      color: #333;
    }
    
    .diagram-body {
      padding: 20px;
    }
    
    .diagram-types {
      margin-bottom: 20px;
    }
    
    .diagram-types h4 {
      margin: 0 0 12px 0;
      font-size: 14px;
      color: #666;
    }
    
    .diagram-type-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(110px, 1fr));
      gap: 8px;
    }
    
    .diagram-type-btn {
      padding: 10px;
      border: 2px solid #e0e0e0;
      border-radius: 8px;
      background: white;
      cursor: pointer;
      text-align: center;
      transition: all 0.2s;
      font-size: 12px;
    }
    
    .diagram-type-btn:hover {
      background: #f8f9fa;
      border-color: #667eea;
    }
    
    .diagram-type-btn.selected {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border-color: #667eea;
    }
    
    .diagram-type-icon {
      font-size: 24px;
      margin-bottom: 4px;
      display: block;
    }
    
    .diagram-input-section {
      margin: 20px 0;
    }
    
    .diagram-input-section label {
      display: block;
      margin-bottom: 8px;
      font-size: 14px;
      color: #666;
    }
    
    .diagram-description {
      width: 100%;
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 6px;
      font-size: 14px;
      resize: vertical;
      font-family: inherit;
    }
    
    .diagram-description:focus {
      outline: none;
      border-color: #667eea;
    }
    
    .diagram-size-section {
      margin: 20px 0;
    }
    
    .diagram-size-section h4 {
      margin: 0 0 12px 0;
      font-size: 14px;
      color: #666;
    }
    
    .diagram-size-inputs {
      display: flex;
      gap: 20px;
    }
    
    .size-input-group {
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .size-input-group label {
      font-size: 14px;
      color: #666;
    }
    
    .size-input-group input {
      width: 80px;
      padding: 6px;
      border: 1px solid #ddd;
      border-radius: 4px;
      font-size: 14px;
    }
    
    .size-input-group span {
      font-size: 14px;
      color: #999;
    }
    
    .diagram-preview-section {
      margin: 20px 0;
    }
    
    .diagram-preview-section h4 {
      margin: 0 0 12px 0;
      font-size: 14px;
      color: #666;
    }
    
    .diagram-preview {
      border: 1px solid #ddd;
      border-radius: 8px;
      padding: 20px;
      background: #f8f9fa;
      min-height: 200px;
      overflow: auto;
      text-align: center;
    }
    
    .diagram-buttons {
      display: flex;
      gap: 10px;
      justify-content: flex-end;
      margin-top: 20px;
      padding-top: 20px;
      border-top: 1px solid #e0e0e0;
    }
    
    .diagram-btn {
      padding: 10px 20px;
      border: 1px solid #ddd;
      border-radius: 6px;
      background: white;
      cursor: pointer;
      font-size: 14px;
      transition: all 0.2s;
    }
    
    .diagram-btn:hover {
      background: #f8f9fa;
    }
    
    .diagram-btn-primary {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
    }
    
    .diagram-btn-primary:hover {
      opacity: 0.9;
    }
    
    .diagram-loading {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(255, 255, 255, 0.95);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      border-radius: 12px;
    }
    
    .diagram-spinner {
      width: 50px;
      height: 50px;
      border: 4px solid #f0f0f0;
      border-top: 4px solid #667eea;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
  </style>

  <!-- AI Chat Panel Container -->
  <div id="chat-panel-container"></div>

  <!-- æ¤œç´¢ãƒ»ç½®æ›ãƒ€ã‚¤ã‚¢ãƒ­ã‚° -->
  <div id="search-replace-overlay" class="search-replace-overlay" style="display: none;">
    <div class="search-replace-dialog">
      <div class="search-replace-header">
        <h3 class="search-replace-title">ğŸ” æ¤œç´¢ã¨ç½®æ›</h3>
        <button class="search-replace-close" id="search-replace-close">Ã—</button>
      </div>
      
      <form class="search-replace-form">
        <div class="search-field-group">
          <label class="search-field-label" for="search-input">æ¤œç´¢</label>
          <div class="search-input-wrapper">
            <input 
              type="text" 
              id="search-input" 
              class="search-input" 
              placeholder="æ¤œç´¢ã™ã‚‹æ–‡å­—åˆ—ã‚’å…¥åŠ›..."
              autocomplete="off"
            >
            <span id="search-count" class="search-count" style="display: none;">0/0</span>
          </div>
        </div>

        <div class="search-field-group">
          <label class="search-field-label" for="replace-input">ç½®æ›</label>
          <div class="search-input-wrapper">
            <input 
              type="text" 
              id="replace-input" 
              class="search-input" 
              placeholder="ç½®æ›å¾Œã®æ–‡å­—åˆ—ã‚’å…¥åŠ›..."
              autocomplete="off"
            >
          </div>
        </div>

        <div class="search-options">
          <div class="search-checkbox-group">
            <input type="checkbox" id="match-case" class="search-checkbox">
            <label for="match-case" class="search-checkbox-label">å¤§æ–‡å­—ã¨å°æ–‡å­—ã‚’åŒºåˆ¥</label>
          </div>
          <div class="search-checkbox-group">
            <input type="checkbox" id="whole-word" class="search-checkbox">
            <label for="whole-word" class="search-checkbox-label">å˜èªå…¨ä½“</label>
          </div>
          <div class="search-checkbox-group">
            <input type="checkbox" id="use-regex" class="search-checkbox">
            <label for="use-regex" class="search-checkbox-label">æ­£è¦è¡¨ç¾</label>
          </div>
        </div>

        <div class="search-actions">
          <div class="search-navigation">
            <button type="button" id="search-prev" class="search-nav-btn" disabled>
              â†‘ å‰ã¸
            </button>
            <button type="button" id="search-next" class="search-nav-btn" disabled>
              â†“ æ¬¡ã¸
            </button>
          </div>
          
          <div class="search-main-actions">
            <button type="button" id="replace-current" class="search-btn search-btn-secondary" disabled>
              ç½®æ›
            </button>
            <button type="button" id="replace-all" class="search-btn search-btn-danger" disabled>
              ã™ã¹ã¦ç½®æ›
            </button>
            <button type="button" id="search-close" class="search-btn search-btn-primary">
              é–‰ã˜ã‚‹
            </button>
          </div>
        </div>
      </form>
    </div>
  </div>

</body>
</html>